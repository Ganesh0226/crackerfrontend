steps:
  - name: 'gcr.io/YOUR_PROJECT_ID/sonar-api-builder'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        echo "ğŸ” Generating token from SonarQube API..."
        TOKEN=$(curl -u admin:admin -X POST "http://localhost:9000/api/user_tokens/generate" -d "name=cloudbuild-token" | jq -r '.token')

        echo "âœ… Token generated: $TOKEN"

        echo "ğŸš€ Running SonarScanner with properties file..."
        export SONAR_TOKEN=$TOKEN
        sonar-scanner
